

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Documentation &mdash; JAXgarden 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Welcome to JAXgarden documentation!" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            JAXgarden
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#attention-modules">Attention Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.attention.MultiHeadAttention"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.attention.MultiHeadAttention.__init__"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#functional-interfaces">Functional Interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.functional.dot_product_attention"><code class="docutils literal notranslate"><span class="pre">dot_product_attention()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-jaxgarden.models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.BaseConfig"><code class="docutils literal notranslate"><span class="pre">BaseConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseConfig.extra"><code class="docutils literal notranslate"><span class="pre">BaseConfig.extra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseConfig.log_level"><code class="docutils literal notranslate"><span class="pre">BaseConfig.log_level</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseConfig.seed"><code class="docutils literal notranslate"><span class="pre">BaseConfig.seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">BaseConfig.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseConfig.update"><code class="docutils literal notranslate"><span class="pre">BaseConfig.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.__init__"><code class="docutils literal notranslate"><span class="pre">BaseModel.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.convert_weights_from_hf"><code class="docutils literal notranslate"><span class="pre">BaseModel.convert_weights_from_hf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.download_from_hf"><code class="docutils literal notranslate"><span class="pre">BaseModel.download_from_hf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.from_hf"><code class="docutils literal notranslate"><span class="pre">BaseModel.from_hf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.iter_safetensors"><code class="docutils literal notranslate"><span class="pre">BaseModel.iter_safetensors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.load"><code class="docutils literal notranslate"><span class="pre">BaseModel.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.save"><code class="docutils literal notranslate"><span class="pre">BaseModel.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.state"><code class="docutils literal notranslate"><span class="pre">BaseModel.state</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.BaseModel.state_dict"><code class="docutils literal notranslate"><span class="pre">BaseModel.state_dict</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.Gemma2Attention"><code class="docutils literal notranslate"><span class="pre">Gemma2Attention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Attention.apply_soft_cap"><code class="docutils literal notranslate"><span class="pre">Gemma2Attention.apply_soft_cap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Attention.rotate_half"><code class="docutils literal notranslate"><span class="pre">Gemma2Attention.rotate_half()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.Gemma2Config"><code class="docutils literal notranslate"><span class="pre">Gemma2Config</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.attn_logits_soft_cap"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.attn_logits_soft_cap</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.context_length"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.context_length</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.dtype"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.eos_token_id"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.eos_token_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.final_logit_soft_cap"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.final_logit_soft_cap</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.head_dim"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.head_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.hidden_size"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.hidden_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.intermediate_size"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.intermediate_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.num_attention_heads"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.num_attention_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.num_hidden_layers"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.num_hidden_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.num_key_value_heads"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.num_key_value_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.pad_token_id"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.pad_token_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.param_dtype"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.param_dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.rms_norm_eps"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.rms_norm_eps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.rope_theta"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.rope_theta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.sliding_window_size"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.sliding_window_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.tie_word_embeddings"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.tie_word_embeddings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2Config.vocab_size"><code class="docutils literal notranslate"><span class="pre">Gemma2Config.vocab_size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.Gemma2ForCausalLM"><code class="docutils literal notranslate"><span class="pre">Gemma2ForCausalLM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2ForCausalLM.config"><code class="docutils literal notranslate"><span class="pre">Gemma2ForCausalLM.config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.Gemma2MLP"><code class="docutils literal notranslate"><span class="pre">Gemma2MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2MLP.geglu"><code class="docutils literal notranslate"><span class="pre">Gemma2MLP.geglu()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.Gemma2RMSNorm"><code class="docutils literal notranslate"><span class="pre">Gemma2RMSNorm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.Gemma2RotaryEmbedding"><code class="docutils literal notranslate"><span class="pre">Gemma2RotaryEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.Gemma2RotaryEmbedding.__call__"><code class="docutils literal notranslate"><span class="pre">Gemma2RotaryEmbedding.__call__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.GenerationMixin"><code class="docutils literal notranslate"><span class="pre">GenerationMixin</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.GenerationMixin.generate"><code class="docutils literal notranslate"><span class="pre">GenerationMixin.generate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.LlamaAttention"><code class="docutils literal notranslate"><span class="pre">LlamaAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.q_proj"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.q_proj</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.k_proj"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.k_proj</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.v_proj"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.v_proj</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.o_proj"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.o_proj</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.rotary_emb"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.rotary_emb</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.head_dim"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.head_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.n_heads"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.n_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.n_kv_heads"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.n_kv_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.__call__"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.__init__"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.apply_rotary_pos_emb"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.apply_rotary_pos_emb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.repeat_kv"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.repeat_kv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaAttention.rotate_half"><code class="docutils literal notranslate"><span class="pre">LlamaAttention.rotate_half()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.LlamaConfig"><code class="docutils literal notranslate"><span class="pre">LlamaConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.dim"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.n_layers"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.n_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.n_heads"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.n_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.n_kv_heads"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.n_kv_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.head_dim"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.head_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.intermediate_size"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.intermediate_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.vocab_size"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.vocab_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.multiple_of"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.multiple_of</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.norm_eps"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.norm_eps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaConfig.rope_theta"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.rope_theta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.head_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.intermediate_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.multiple_of</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.n_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.n_kv_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.n_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.norm_eps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.rope_theta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">LlamaConfig.vocab_size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.LlamaForCausalLM"><code class="docutils literal notranslate"><span class="pre">LlamaForCausalLM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaForCausalLM.token_embed"><code class="docutils literal notranslate"><span class="pre">LlamaForCausalLM.token_embed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaForCausalLM.layers"><code class="docutils literal notranslate"><span class="pre">LlamaForCausalLM.layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaForCausalLM.lm_head"><code class="docutils literal notranslate"><span class="pre">LlamaForCausalLM.lm_head</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaForCausalLM.norm"><code class="docutils literal notranslate"><span class="pre">LlamaForCausalLM.norm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaForCausalLM.__call__"><code class="docutils literal notranslate"><span class="pre">LlamaForCausalLM.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaForCausalLM.__init__"><code class="docutils literal notranslate"><span class="pre">LlamaForCausalLM.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaForCausalLM.convert_weights_from_hf"><code class="docutils literal notranslate"><span class="pre">LlamaForCausalLM.convert_weights_from_hf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.LlamaMLP"><code class="docutils literal notranslate"><span class="pre">LlamaMLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaMLP.gate_proj"><code class="docutils literal notranslate"><span class="pre">LlamaMLP.gate_proj</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaMLP.up_proj"><code class="docutils literal notranslate"><span class="pre">LlamaMLP.up_proj</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaMLP.down_proj"><code class="docutils literal notranslate"><span class="pre">LlamaMLP.down_proj</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaMLP.__call__"><code class="docutils literal notranslate"><span class="pre">LlamaMLP.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaMLP.__init__"><code class="docutils literal notranslate"><span class="pre">LlamaMLP.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.LlamaRMSNorm"><code class="docutils literal notranslate"><span class="pre">LlamaRMSNorm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaRMSNorm.norm_weights"><code class="docutils literal notranslate"><span class="pre">LlamaRMSNorm.norm_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaRMSNorm.norm_eps"><code class="docutils literal notranslate"><span class="pre">LlamaRMSNorm.norm_eps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaRMSNorm.__call__"><code class="docutils literal notranslate"><span class="pre">LlamaRMSNorm.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaRMSNorm.__init__"><code class="docutils literal notranslate"><span class="pre">LlamaRMSNorm.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.LlamaRotaryEmbedding"><code class="docutils literal notranslate"><span class="pre">LlamaRotaryEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaRotaryEmbedding.dim"><code class="docutils literal notranslate"><span class="pre">LlamaRotaryEmbedding.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaRotaryEmbedding.base"><code class="docutils literal notranslate"><span class="pre">LlamaRotaryEmbedding.base</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaRotaryEmbedding.__call__"><code class="docutils literal notranslate"><span class="pre">LlamaRotaryEmbedding.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaRotaryEmbedding.__init__"><code class="docutils literal notranslate"><span class="pre">LlamaRotaryEmbedding.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.LlamaTransformerBlock"><code class="docutils literal notranslate"><span class="pre">LlamaTransformerBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaTransformerBlock.input_layernorm"><code class="docutils literal notranslate"><span class="pre">LlamaTransformerBlock.input_layernorm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaTransformerBlock.attention"><code class="docutils literal notranslate"><span class="pre">LlamaTransformerBlock.attention</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaTransformerBlock.post_attention_layernorm"><code class="docutils literal notranslate"><span class="pre">LlamaTransformerBlock.post_attention_layernorm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaTransformerBlock.mlp"><code class="docutils literal notranslate"><span class="pre">LlamaTransformerBlock.mlp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaTransformerBlock.__call__"><code class="docutils literal notranslate"><span class="pre">LlamaTransformerBlock.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.LlamaTransformerBlock.__init__"><code class="docutils literal notranslate"><span class="pre">LlamaTransformerBlock.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.ModernBERTEncoder"><code class="docutils literal notranslate"><span class="pre">ModernBERTEncoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBERTEncoder.__call__"><code class="docutils literal notranslate"><span class="pre">ModernBERTEncoder.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBERTEncoder.__init__"><code class="docutils literal notranslate"><span class="pre">ModernBERTEncoder.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.ModernBERTForMaskedLM"><code class="docutils literal notranslate"><span class="pre">ModernBERTForMaskedLM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBERTForMaskedLM.__call__"><code class="docutils literal notranslate"><span class="pre">ModernBERTForMaskedLM.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBERTForMaskedLM.__init__"><code class="docutils literal notranslate"><span class="pre">ModernBERTForMaskedLM.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.ModernBertAttention"><code class="docutils literal notranslate"><span class="pre">ModernBertAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBertAttention.__call__"><code class="docutils literal notranslate"><span class="pre">ModernBertAttention.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBertAttention.__init__"><code class="docutils literal notranslate"><span class="pre">ModernBertAttention.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.ModernBertEmbeddings"><code class="docutils literal notranslate"><span class="pre">ModernBertEmbeddings</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBertEmbeddings.__call__"><code class="docutils literal notranslate"><span class="pre">ModernBertEmbeddings.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBertEmbeddings.__init__"><code class="docutils literal notranslate"><span class="pre">ModernBertEmbeddings.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.ModernBertLayer"><code class="docutils literal notranslate"><span class="pre">ModernBertLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBertLayer.__call__"><code class="docutils literal notranslate"><span class="pre">ModernBertLayer.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBertLayer.__init__"><code class="docutils literal notranslate"><span class="pre">ModernBertLayer.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jaxgarden.models.ModernBertMLP"><code class="docutils literal notranslate"><span class="pre">ModernBertMLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBertMLP.__call__"><code class="docutils literal notranslate"><span class="pre">ModernBertMLP.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jaxgarden.models.ModernBertMLP.__init__"><code class="docutils literal notranslate"><span class="pre">ModernBertMLP.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">JAXgarden</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="attention-modules">
<h2>Attention Modules<a class="headerlink" href="#attention-modules" title="Link to this heading"></a></h2>
<p id="module-jaxgarden.attention">Attention modules for JAXgarden.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.attention.MultiHeadAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.attention.</span></span><span class="sig-name descname"><span class="pre">MultiHeadAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/attention/multi_head_attention.html#MultiHeadAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.attention.MultiHeadAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/attention.html#flax.nnx.MultiHeadAttention" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiHeadAttention</span></code></a></p>
<p>Multi-head attention with support for Flash Attention.</p>
<p>This class extends Flax NNX’s MultiHeadAttention to support Flash Attention
through JAX’s dot_product_attention implementation parameter.</p>
<p>Example usage:</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
import jax
import jax.numpy as jnp
import flax.nnx as nnx
from jax_layers.attention import MultiHeadAttention</p>
<p># Create a MultiHeadAttention module with Flash Attention support
attention = MultiHeadAttention(</p>
<blockquote>
<div><p>num_heads=8,
in_features=512,
implementation=”cudnn”,  # Use cuDNN’s Flash Attention if available
rngs=nnx.Rngs(0),</p>
</div></blockquote>
<p>)</p>
<p># Initialize parameters
key = jax.random.PRNGKey(0)
x = jax.random.normal(key, (2, 128, 512))  # (batch, seq_length, hidden_dim)</p>
<p># Create a causal attention mask
mask = jnp.tril(jnp.ones((2, 1, 128, 128)))  # (batch, 1, q_len, kv_len)</p>
<p># Apply the model
output = attention(x, mask=mask)
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.attention.MultiHeadAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_heads:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_features:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_features:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadcast_dropout:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic:</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision:</span> <span class="pre">~jax._src.lax.lax.Precision</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_init:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">variance_scaling.&lt;locals&gt;.init&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_kernel_init:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_init:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">zeros&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_bias_init:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bias:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_fn:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decode:</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_qk:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_dot_general:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dot_general:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_dot_general_cls:</span> <span class="pre">type</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dot_general_cls:</span> <span class="pre">type</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implementation:</span> <span class="pre">~typing.Literal['xla'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'cudnn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'flash']</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs:</span> <span class="pre">~flax.nnx.rnglib.Rngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/attention/multi_head_attention.html#MultiHeadAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.attention.MultiHeadAttention.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the MultiHeadAttention module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_heads</strong> – number of attention heads.</p></li>
<li><p><strong>in_features</strong> – int or tuple with number of input features.</p></li>
<li><p><strong>qkv_features</strong> – dimension of the key, query, and value.</p></li>
<li><p><strong>out_features</strong> – dimension of the last projection.</p></li>
<li><p><strong>dtype</strong> – the dtype of the computation.</p></li>
<li><p><strong>param_dtype</strong> – the dtype passed to parameter initializers.</p></li>
<li><p><strong>broadcast_dropout</strong> – bool: use a broadcasted dropout along batch dims.</p></li>
<li><p><strong>dropout_rate</strong> – dropout rate.</p></li>
<li><p><strong>deterministic</strong> – if false, the attention weight is masked randomly using dropout.</p></li>
<li><p><strong>precision</strong> – numerical precision of the computation.</p></li>
<li><p><strong>kernel_init</strong> – initializer for the kernel of the Dense layers.</p></li>
<li><p><strong>out_kernel_init</strong> – initializer for the kernel of the output Dense layer.</p></li>
<li><p><strong>bias_init</strong> – initializer for the bias of the Dense layers.</p></li>
<li><p><strong>out_bias_init</strong> – initializer for the bias of the output Dense layer.</p></li>
<li><p><strong>use_bias</strong> – bool: whether pointwise QKVO dense transforms use bias.</p></li>
<li><p><strong>attention_fn</strong> – dot_product_attention or compatible function.</p></li>
<li><p><strong>decode</strong> – whether to prepare and use an autoregressive cache.</p></li>
<li><p><strong>normalize_qk</strong> – should QK normalization be applied.</p></li>
<li><p><strong>qkv_dot_general</strong> – dot_general function for QKV projection.</p></li>
<li><p><strong>out_dot_general</strong> – dot_general function for output projection.</p></li>
<li><p><strong>qkv_dot_general_cls</strong> – dot_general class for QKV projection.</p></li>
<li><p><strong>out_dot_general_cls</strong> – dot_general class for output projection.</p></li>
<li><p><strong>implementation</strong> – which implementation to use for attention. Options are:
- “xla”: Use XLA’s default implementation
- “cudnn”: Use cuDNN’s Flash Attention implementation (if available)
- “flash”: Alias for “cudnn”
- None: Automatically select the best available implementation</p></li>
<li><p><strong>rngs</strong> – random number generator keys.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="functional-interfaces">
<h2>Functional Interfaces<a class="headerlink" href="#functional-interfaces" title="Link to this heading"></a></h2>
<p id="module-jaxgarden.functional">Functional implementations for JAXgarden.</p>
<dl class="py function">
<dt class="sig sig-object py" id="jaxgarden.functional.dot_product_attention">
<span class="sig-prename descclassname"><span class="pre">jaxgarden.functional.</span></span><span class="sig-name descname"><span class="pre">dot_product_attention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadcast_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.dtype.html#jax.numpy.dtype" title="(in JAX)"><span class="pre">dtype</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/jax.lax.html#jax.lax.Precision" title="(in JAX)"><span class="pre">Precision</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implementation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'xla'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'cudnn'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'flash'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><span class="pre">object</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/functional/attention.html#dot_product_attention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.functional.dot_product_attention" title="Link to this definition"></a></dt>
<dd><p>Computes dot-product attention with optional Flash Attention support.</p>
<p>This function provides a wrapper around JAX’s dot_product_attention with the option
to use Flash Attention when available. It follows the Flax NNX interface while
allowing the use of different implementations through the implementation parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – queries for calculating attention with shape of
<cite>[batch…, q_length, num_heads, qk_depth_per_head]</cite>.</p></li>
<li><p><strong>key</strong> – keys for calculating attention with shape of
<cite>[batch…, kv_length, num_heads, qk_depth_per_head]</cite>.</p></li>
<li><p><strong>value</strong> – values to be used in attention with shape of
<cite>[batch…, kv_length, num_heads, v_depth_per_head]</cite>.</p></li>
<li><p><strong>bias</strong> – bias for the attention weights. This should be broadcastable to
the shape [batch…, num_heads, q_length, kv_length].</p></li>
<li><p><strong>mask</strong> – mask for the attention weights. This should be broadcastable to
the shape [batch…, num_heads, q_length, kv_length].</p></li>
<li><p><strong>broadcast_dropout</strong> – bool: use a broadcasted dropout along batch dims.</p></li>
<li><p><strong>dropout_rng</strong> – JAX PRNGKey: to be used for dropout.</p></li>
<li><p><strong>dropout_rate</strong> – dropout rate.</p></li>
<li><p><strong>deterministic</strong> – bool, deterministic or not (to apply dropout).</p></li>
<li><p><strong>dtype</strong> – the dtype of the computation (default: infer from inputs).</p></li>
<li><p><strong>precision</strong> – numerical precision of the computation.</p></li>
<li><p><strong>implementation</strong> – which implementation to use. Options are:
- “xla”: Use XLA’s default implementation
- “cudnn”: Use cuDNN’s Flash Attention implementation (if available)
- “flash”: Alias for “cudnn”
- None: Automatically select the best available implementation</p></li>
<li><p><strong>module</strong> – the Module that will sow the attention weights.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output of shape <cite>[batch…, q_length, num_heads, v_depth_per_head]</cite>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jaxgarden.models">
<span id="models"></span><h2>Models<a class="headerlink" href="#module-jaxgarden.models" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.BaseConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">BaseConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_level:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'info'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra:</span> <span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base configuration for all the models implemented in the JAXgarden library.</p>
<p>Each model implemented in JAXgarden should subclass this class for configuration management.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.BaseConfig.extra">
<span class="sig-name descname"><span class="pre">extra</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jaxgarden.models.BaseConfig.extra" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.BaseConfig.log_level">
<span class="sig-name descname"><span class="pre">log_level</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'info'</span></em><a class="headerlink" href="#jaxgarden.models.BaseConfig.log_level" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.BaseConfig.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">42</span></em><a class="headerlink" href="#jaxgarden.models.BaseConfig.seed" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseConfig.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseConfig.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseConfig.to_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseConfig.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseConfig.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseConfig.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Base class for all the models implemented in the JAXgarden library.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config:</span> <span class="pre">~jaxgarden.models.base.BaseConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision:</span> <span class="pre">~jax._src.lax.lax.Precision</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs:</span> <span class="pre">~flax.nnx.rnglib.Rngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseModel.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the model.</p>
<blockquote>
<div><blockquote>
<div><p>Args:</p>
</div></blockquote>
<p>config: config class for this model.
dtype: Data type in which computation is performed.</p>
</div></blockquote>
<dl class="simple">
<dt>param_dtype: Data type in which params are stored.</dt><dd><p>precision: Numerical precision.
rngs: Random number generators for param initialization etc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.convert_weights_from_hf">
<span class="sig-name descname"><span class="pre">convert_weights_from_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/state.html#flax.nnx.State" title="(in Flax)"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseModel.convert_weights_from_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseModel.convert_weights_from_hf" title="Link to this definition"></a></dt>
<dd><p>Convert weights from Hugging Face Hub to the model’s state.</p>
<p>This method should be implemented in downstream classes
to support conversion from HuggingFace format.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.download_from_hf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">download_from_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseModel.download_from_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseModel.download_from_hf" title="Link to this definition"></a></dt>
<dd><p>Downloads the model from the Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_id</strong> – The repository ID of the model to download.</p></li>
<li><p><strong>local_dir</strong> – The local directory to save the model to.</p></li>
<li><p><strong>token</strong> – <p>The hf auth token to download the model with.
- If <cite>True</cite>, the token is read from the HuggingFace config</p>
<blockquote>
<div><p>folder.</p>
</div></blockquote>
<ul>
<li><p>If a string, it’s used as the authentication token.</p></li>
</ul>
</p></li>
<li><p><strong>force_download</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>) – Whether the file should be downloaded even if it already exists in the local cache.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.from_hf">
<span class="sig-name descname"><span class="pre">from_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_repo_or_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_in_orbax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_hf_after_conversion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseModel.from_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseModel.from_hf" title="Link to this definition"></a></dt>
<dd><p>Downloads the model from the Hugging Face Hub and returns a new instance of the model.</p>
<dl class="simple">
<dt>It can also save the converted weights in an Orbax checkpoint</dt><dd><p>and removes the original HF checkpoint after conversion.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_repo_or_id</strong> – The repository ID or name of the model to download.</p></li>
<li><p><strong>token</strong> – The token to use for authentication with the Hugging Face Hub.</p></li>
<li><p><strong>force_download</strong> – (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>):
Whether the file should be downloaded even if it already exists in the local cache.</p></li>
<li><p><strong>save_in_orbax</strong> – Whether to save the converted weights in an Orbax checkpoint.</p></li>
<li><p><strong>remove_hf_after_conversion</strong> – Whether to remove the downloaded HuggingFace checkpoint
after conversion.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.iter_safetensors">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iter_safetensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_model_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseModel.iter_safetensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseModel.iter_safetensors" title="Link to this definition"></a></dt>
<dd><p>Helper function to lazily load params from safetensors file.</p>
<p>Use this static method to iterate over weights for conversion tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path_to_model_weights</strong> – Path to directory containing .safetensors files.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><span class="pre">Module</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseModel.load" title="Link to this definition"></a></dt>
<dd><p>Loads the model state from a directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> – The directory path to load the model state from.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/base.html#BaseModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.BaseModel.save" title="Link to this definition"></a></dt>
<dd><p>Saves the model state to a directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> – The directory path to save the model state to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/state.html#flax.nnx.State" title="(in Flax)"><span class="pre">State</span></a></em><a class="headerlink" href="#jaxgarden.models.BaseModel.state" title="Link to this definition"></a></dt>
<dd><p>Splits state from the graph and returns it</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxgarden.models.BaseModel.state_dict">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jaxgarden.models.BaseModel.state_dict" title="Link to this definition"></a></dt>
<dd><p>Splits state from the graph and returns it as a dictionary.</p>
<p>It can be used for serialization with orbax.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Attention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">Gemma2Attention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2Attention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2Attention" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Gemma 2 Attention mechanism with GQA and RoPE.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Attention.apply_soft_cap">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">apply_soft_cap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2Attention.apply_soft_cap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2Attention.apply_soft_cap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Attention.rotate_half">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rotate_half</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2Attention.rotate_half"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2Attention.rotate_half" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">Gemma2Config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_level:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'info'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra:</span> <span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">256000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">16384</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden_layers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_attention_heads:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_key_value_heads:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_dim:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_norm_eps:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rope_theta:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_logits_soft_cap:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_logit_soft_cap:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sliding_window_size:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token_id:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos_token_id:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context_length:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_dtype:</span> <span class="pre">~typing.Any</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'jax.numpy.bfloat16'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~typing.Any</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'jax.numpy.bfloat16'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_word_embeddings:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2Config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2Config" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxgarden.models.BaseConfig" title="jaxgarden.models.base.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseConfig</span></code></a></p>
<p>Configuration for Gemma 2. Variant defaults below (from technical report):</p>
<p>This default configuration is based on the original Gemma 2 2B variant.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.attn_logits_soft_cap">
<span class="sig-name descname"><span class="pre">attn_logits_soft_cap</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50.0</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.attn_logits_soft_cap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.context_length">
<span class="sig-name descname"><span class="pre">context_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8192</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.context_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#jaxgarden.models.Gemma2Config.dtype" title="Link to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">bfloat16</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.eos_token_id">
<span class="sig-name descname"><span class="pre">eos_token_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.eos_token_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.final_logit_soft_cap">
<span class="sig-name descname"><span class="pre">final_logit_soft_cap</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">30.0</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.final_logit_soft_cap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.head_dim">
<span class="sig-name descname"><span class="pre">head_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.head_dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.hidden_size">
<span class="sig-name descname"><span class="pre">hidden_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2048</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.hidden_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.intermediate_size">
<span class="sig-name descname"><span class="pre">intermediate_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16384</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.intermediate_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.num_attention_heads">
<span class="sig-name descname"><span class="pre">num_attention_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.num_attention_heads" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.num_hidden_layers">
<span class="sig-name descname"><span class="pre">num_hidden_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">18</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.num_hidden_layers" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.num_key_value_heads">
<span class="sig-name descname"><span class="pre">num_key_value_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.num_key_value_heads" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.pad_token_id">
<span class="sig-name descname"><span class="pre">pad_token_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.pad_token_id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.param_dtype">
<span class="sig-name descname"><span class="pre">param_dtype</span></span><a class="headerlink" href="#jaxgarden.models.Gemma2Config.param_dtype" title="Link to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">bfloat16</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.rms_norm_eps">
<span class="sig-name descname"><span class="pre">rms_norm_eps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.rms_norm_eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.rope_theta">
<span class="sig-name descname"><span class="pre">rope_theta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10000.0</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.rope_theta" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.sliding_window_size">
<span class="sig-name descname"><span class="pre">sliding_window_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4096</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.sliding_window_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.tie_word_embeddings">
<span class="sig-name descname"><span class="pre">tie_word_embeddings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.tie_word_embeddings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2Config.vocab_size">
<span class="sig-name descname"><span class="pre">vocab_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256000</span></em><a class="headerlink" href="#jaxgarden.models.Gemma2Config.vocab_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2ForCausalLM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">Gemma2ForCausalLM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2ForCausalLM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2ForCausalLM" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxgarden.models.GenerationMixin" title="jaxgarden.models.generation_utils.GenerationMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerationMixin</span></code></a>, <a class="reference internal" href="#jaxgarden.models.BaseModel" title="jaxgarden.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2ForCausalLM.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxgarden.models.Gemma2Config" title="jaxgarden.models.gemma2.Gemma2Config"><span class="pre">Gemma2Config</span></a></em><a class="headerlink" href="#jaxgarden.models.Gemma2ForCausalLM.config" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2MLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">Gemma2MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2MLP" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2MLP.geglu">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geglu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2MLP.geglu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2MLP.geglu" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2RMSNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">Gemma2RMSNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2RMSNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2RMSNorm" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Root Mean Square Layer Normalization.</p>
<p>This implementation follows the RMSNorm implementation in DeepMind’s GEMMA repository:</p>
<p><a class="reference external" href="https://github.com/google-deepmind/gemma/blob/main/gemma/layers.py#L41">https://github.com/google-deepmind/gemma/blob/main/gemma/layers.py#L41</a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2RotaryEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">Gemma2RotaryEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2RotaryEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2RotaryEmbedding" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Applies Rotary Position Embedding (RoPE) to input tensors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.Gemma2RotaryEmbedding.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/gemma2.html#Gemma2RotaryEmbedding.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.Gemma2RotaryEmbedding.__call__" title="Link to this definition"></a></dt>
<dd><p>Applies RoPE to the input tensor using cached sin/cos values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input tensor of shape [B, L, N, H].</p></li>
<li><p><strong>position_ids</strong> – Position indices of shape [B, L].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rotated tensor of the same shape as x.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.GenerationMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">GenerationMixin</span></span><a class="reference internal" href="../_modules/jaxgarden/models/generation_utils.html#GenerationMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.GenerationMixin" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Mixin that adds text generation capabilities,
including sampling with temperature, top-k, top-p,
and min-probability filtering, for CausalLMs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.GenerationMixin.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos_token_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_jit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/generation_utils.html#GenerationMixin.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.GenerationMixin.generate" title="Link to this definition"></a></dt>
<dd><p>Generate tokens autoregressively with various sampling methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_ids</strong> – Initial token IDs of shape [batch_size, seq_len].</p></li>
<li><p><strong>attention_mask</strong> – Optional attention mask</p></li>
<li><p><strong>max_length</strong> – Maximum length for generated sequences.</p></li>
<li><p><strong>temperature</strong> – Temperature for sampling.</p></li>
<li><p><strong>top_k</strong> – If specified, only sample from the top-k logits.</p></li>
<li><p><strong>top_p</strong> – If specified, only sample from the smallest set of logits
whose cumulative probability exceeds p.</p></li>
<li><p><strong>min_p</strong> – If specified, only consider logits with prob &gt;= min_p * prob(max logit).</p></li>
<li><p><strong>do_sample</strong> – If True, use sampling; otherwise use greedy/beam search.</p></li>
<li><p><strong>pad_token_id</strong> – Token ID to use for padding.</p></li>
<li><p><strong>eos_token_id</strong> – Token ID that signals the end of generation.</p></li>
<li><p><strong>rng</strong> – Optional PRNG key for sampling.</p></li>
<li><p><strong>use_jit</strong> – If True, use jax.jit to compile the generate function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated token IDs of shape [batch_size, max_length].</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">LlamaAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Multi-headed attention with support for Group Query Attention (GQA).</p>
<p>This implements the LLama attention mechanism with rotary position embeddings (RoPE)
and support for fewer key-value heads than query heads (GQA).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.q_proj">
<span class="sig-name descname"><span class="pre">q_proj</span></span><a class="headerlink" href="#jaxgarden.models.LlamaAttention.q_proj" title="Link to this definition"></a></dt>
<dd><p>Linear projection for queries</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.k_proj">
<span class="sig-name descname"><span class="pre">k_proj</span></span><a class="headerlink" href="#jaxgarden.models.LlamaAttention.k_proj" title="Link to this definition"></a></dt>
<dd><p>Linear projection for keys</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.v_proj">
<span class="sig-name descname"><span class="pre">v_proj</span></span><a class="headerlink" href="#jaxgarden.models.LlamaAttention.v_proj" title="Link to this definition"></a></dt>
<dd><p>Linear projection for values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.o_proj">
<span class="sig-name descname"><span class="pre">o_proj</span></span><a class="headerlink" href="#jaxgarden.models.LlamaAttention.o_proj" title="Link to this definition"></a></dt>
<dd><p>Linear projection for output</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.rotary_emb">
<span class="sig-name descname"><span class="pre">rotary_emb</span></span><a class="headerlink" href="#jaxgarden.models.LlamaAttention.rotary_emb" title="Link to this definition"></a></dt>
<dd><p>Rotary position embeddings</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.head_dim">
<span class="sig-name descname"><span class="pre">head_dim</span></span><a class="headerlink" href="#jaxgarden.models.LlamaAttention.head_dim" title="Link to this definition"></a></dt>
<dd><p>Dimension of each attention head</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.n_heads">
<span class="sig-name descname"><span class="pre">n_heads</span></span><a class="headerlink" href="#jaxgarden.models.LlamaAttention.n_heads" title="Link to this definition"></a></dt>
<dd><p>Number of attention heads</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.n_kv_heads">
<span class="sig-name descname"><span class="pre">n_kv_heads</span></span><a class="headerlink" href="#jaxgarden.models.LlamaAttention.n_kv_heads" title="Link to this definition"></a></dt>
<dd><p>Number of key/value heads</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaAttention.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaAttention.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply self-attention using queries, keys, and values derived from input x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input tensor of shape [batch_size, seq_len, dim]</p></li>
<li><p><strong>position_ids</strong> – Position indices of shape [batch_size, seq_len]</p></li>
<li><p><strong>attention_mask</strong> – Additive attention mask of shape (batch_size, 1, q_len, kv_len)
or a shape that can be broadcasted to this shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor of shape [batch_size, seq_len, dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_kv_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rope_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaAttention.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize attention module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_idx</strong> – Index of the layer</p></li>
<li><p><strong>dim</strong> – Size of hidden states</p></li>
<li><p><strong>n_heads</strong> – Number of attention heads</p></li>
<li><p><strong>n_kv_heads</strong> – Number of key/value heads</p></li>
<li><p><strong>head_dim</strong> – Dimension of each attention head</p></li>
<li><p><strong>rope_theta</strong> – Base for rotary position embeddings</p></li>
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.apply_rotary_pos_emb">
<span class="sig-name descname"><span class="pre">apply_rotary_pos_emb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unsqueeze_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaAttention.apply_rotary_pos_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaAttention.apply_rotary_pos_emb" title="Link to this definition"></a></dt>
<dd><p>Apply rotary position embeddings to query and key tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> – Query tensor</p></li>
<li><p><strong>k</strong> – Key tensor</p></li>
<li><p><strong>cos</strong> – Cosine component of rotary embeddings</p></li>
<li><p><strong>sin</strong> – Sine component of rotary embeddings</p></li>
<li><p><strong>unsqueeze_dim</strong> – Dimension to unsqueeze cosine and sine components</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (rotated_q, rotated_k)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.repeat_kv">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">repeat_kv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_repeat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaAttention.repeat_kv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaAttention.repeat_kv" title="Link to this definition"></a></dt>
<dd><p>Repeat key/value heads to match the number of query heads.</p>
<p>When using GQA, we need to repeat each key/value head to match
the number of query heads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_states</strong> – Key or value tensor of shape [batch, n_kv_heads, seq_len, head_dim]</p></li>
<li><p><strong>n_repeat</strong> – Number of times to repeat each key/value head</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor with repeated key/value heads</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaAttention.rotate_half">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rotate_half</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaAttention.rotate_half"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaAttention.rotate_half" title="Link to this definition"></a></dt>
<dd><p>Rotate half the hidden dims of the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Input tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor with half the dimensions rotated</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">LlamaConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_level:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'info'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra:</span> <span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_kv_heads:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_dim:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">14336</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">128256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_of:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eps:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rope_theta:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">500000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxgarden.models.BaseConfig" title="jaxgarden.models.base.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseConfig</span></code></a></p>
<p>Configuration for LLama model.</p>
<p>This configuration class extends BaseConfig and contains all the parameters
required to initialize a LLama model. It includes settings for model architecture,
attention mechanisms, and other hyperparameters.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.dim" title="Link to this definition"></a></dt>
<dd><p>Size of hidden states</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.n_layers">
<span class="sig-name descname"><span class="pre">n_layers</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.n_layers" title="Link to this definition"></a></dt>
<dd><p>Number of transformer layers</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.n_heads">
<span class="sig-name descname"><span class="pre">n_heads</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.n_heads" title="Link to this definition"></a></dt>
<dd><p>Number of attention heads</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.n_kv_heads">
<span class="sig-name descname"><span class="pre">n_kv_heads</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.n_kv_heads" title="Link to this definition"></a></dt>
<dd><p>Number of key/value heads (for group query attention)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.head_dim">
<span class="sig-name descname"><span class="pre">head_dim</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.head_dim" title="Link to this definition"></a></dt>
<dd><p>Dimension of each attention head</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.intermediate_size">
<span class="sig-name descname"><span class="pre">intermediate_size</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.intermediate_size" title="Link to this definition"></a></dt>
<dd><p>Size of MLP intermediate layer</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.vocab_size">
<span class="sig-name descname"><span class="pre">vocab_size</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.vocab_size" title="Link to this definition"></a></dt>
<dd><p>Size of vocabulary</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.multiple_of">
<span class="sig-name descname"><span class="pre">multiple_of</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.multiple_of" title="Link to this definition"></a></dt>
<dd><p>Ensure dimensions are multiples of this value</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.norm_eps">
<span class="sig-name descname"><span class="pre">norm_eps</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.norm_eps" title="Link to this definition"></a></dt>
<dd><p>Epsilon for layer normalization</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaConfig.rope_theta">
<span class="sig-name descname"><span class="pre">rope_theta</span></span><a class="headerlink" href="#jaxgarden.models.LlamaConfig.rope_theta" title="Link to this definition"></a></dt>
<dd><p>Base for rotary position embeddings</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2048</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">head_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">64</span></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">intermediate_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">14336</span></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">multiple_of</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">n_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">32</span></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">n_kv_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">n_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">norm_eps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">rope_theta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">500000.0</span></em><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">vocab_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">128256</span></em><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaForCausalLM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">LlamaForCausalLM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaForCausalLM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaForCausalLM" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxgarden.models.GenerationMixin" title="jaxgarden.models.generation_utils.GenerationMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerationMixin</span></code></a>, <a class="reference internal" href="#jaxgarden.models.BaseModel" title="jaxgarden.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>LLama model for causal language modeling.</p>
<p>This implements the full LLama model for generating text.
It consists of token embeddings, transformer layers, and language modeling head.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaForCausalLM.token_embed">
<span class="sig-name descname"><span class="pre">token_embed</span></span><a class="headerlink" href="#jaxgarden.models.LlamaForCausalLM.token_embed" title="Link to this definition"></a></dt>
<dd><p>Token embedding layer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaForCausalLM.layers">
<span class="sig-name descname"><span class="pre">layers</span></span><a class="headerlink" href="#jaxgarden.models.LlamaForCausalLM.layers" title="Link to this definition"></a></dt>
<dd><p>List of transformer blocks</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaForCausalLM.lm_head">
<span class="sig-name descname"><span class="pre">lm_head</span></span><a class="headerlink" href="#jaxgarden.models.LlamaForCausalLM.lm_head" title="Link to this definition"></a></dt>
<dd><p>Linear layer for language modeling</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaForCausalLM.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><a class="headerlink" href="#jaxgarden.models.LlamaForCausalLM.norm" title="Link to this definition"></a></dt>
<dd><p>Final layer normalization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaForCausalLM.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaForCausalLM.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaForCausalLM.__call__" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the LLama model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_ids</strong> – Input token ids of shape [batch_size, seq_len]</p></li>
<li><p><strong>attention_mask</strong> – Boolean attention mask of shape [batch_size, seq_len]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Logits for next token prediction of shape [batch_size, seq_len, vocab_size]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaForCausalLM.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config:</span> <span class="pre">~jaxgarden.models.llama.LlamaConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision:</span> <span class="pre">~jax._src.lax.lax.Precision</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs:</span> <span class="pre">~flax.nnx.rnglib.Rngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaForCausalLM.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaForCausalLM.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize LlamaForCausalLM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Model configuration</p></li>
<li><p><strong>dtype</strong> – Data type for computation</p></li>
<li><p><strong>param_dtype</strong> – Data type for parameters</p></li>
<li><p><strong>precision</strong> – Precision for matrix multiplication</p></li>
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaForCausalLM.convert_weights_from_hf">
<span class="sig-name descname"><span class="pre">convert_weights_from_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/state.html#flax.nnx.State" title="(in Flax)"><span class="pre">State</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaForCausalLM.convert_weights_from_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaForCausalLM.convert_weights_from_hf" title="Link to this definition"></a></dt>
<dd><p>Convert weights from Hugging Face Hub to the model’s state.</p>
<p>This method should be implemented in downstream classes
to support conversion from HuggingFace format.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaMLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">LlamaMLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaMLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaMLP" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>LLama’s MLP implementation with SwiGLU activation.</p>
<p>This implements the SwiGLU MLP used in LLama models:
down_proj(silu(gate_proj(x)) * up_proj(x))</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaMLP.gate_proj">
<span class="sig-name descname"><span class="pre">gate_proj</span></span><a class="headerlink" href="#jaxgarden.models.LlamaMLP.gate_proj" title="Link to this definition"></a></dt>
<dd><p>Linear projection for gate</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaMLP.up_proj">
<span class="sig-name descname"><span class="pre">up_proj</span></span><a class="headerlink" href="#jaxgarden.models.LlamaMLP.up_proj" title="Link to this definition"></a></dt>
<dd><p>Linear projection for up-projection</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaMLP.down_proj">
<span class="sig-name descname"><span class="pre">down_proj</span></span><a class="headerlink" href="#jaxgarden.models.LlamaMLP.down_proj" title="Link to this definition"></a></dt>
<dd><p>Linear projection for down-projection</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaMLP.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaMLP.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaMLP.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply SwiGLU MLP to input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Input tensor of shape [batch_size, seq_len, dim]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor of shape [batch_size, seq_len, dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaMLP.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaMLP.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaMLP.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize MLP module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_idx</strong> – Index of the layer</p></li>
<li><p><strong>dim</strong> – Size of hidden states</p></li>
<li><p><strong>intermediate_size</strong> – Size of intermediate layer</p></li>
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRMSNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">LlamaRMSNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaRMSNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaRMSNorm" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Root Mean Square Layer Normalization.</p>
<p>This implementation follows the RMSNorm paper: <a class="reference external" href="https://arxiv.org/abs/1910.07467">https://arxiv.org/abs/1910.07467</a>
Instead of using mean and variance like traditional LayerNorm, RMSNorm only uses
the root mean square of the inputs for normalization.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRMSNorm.norm_weights">
<span class="sig-name descname"><span class="pre">norm_weights</span></span><a class="headerlink" href="#jaxgarden.models.LlamaRMSNorm.norm_weights" title="Link to this definition"></a></dt>
<dd><p>The learned scale parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRMSNorm.norm_eps">
<span class="sig-name descname"><span class="pre">norm_eps</span></span><a class="headerlink" href="#jaxgarden.models.LlamaRMSNorm.norm_eps" title="Link to this definition"></a></dt>
<dd><p>Small constant for numerical stability</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRMSNorm.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaRMSNorm.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaRMSNorm.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply RMS normalization to input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hidden_states</strong> – Input tensor of shape […, dim]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized tensor with same shape as input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRMSNorm.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaRMSNorm.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaRMSNorm.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize RMSNorm module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> – Dimension of the input tensor</p></li>
<li><p><strong>norm_eps</strong> – Small constant for numerical stability</p></li>
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRotaryEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">LlamaRotaryEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaRotaryEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaRotaryEmbedding" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Rotary Position Embedding (RoPE) implementation for LLama.</p>
<p>Based on: <a class="reference external" href="https://arxiv.org/abs/2104.09864">https://arxiv.org/abs/2104.09864</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRotaryEmbedding.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#jaxgarden.models.LlamaRotaryEmbedding.dim" title="Link to this definition"></a></dt>
<dd><p>Dimension of the embeddings</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRotaryEmbedding.base">
<span class="sig-name descname"><span class="pre">base</span></span><a class="headerlink" href="#jaxgarden.models.LlamaRotaryEmbedding.base" title="Link to this definition"></a></dt>
<dd><p>Base for the sinusoidal functions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRotaryEmbedding.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaRotaryEmbedding.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaRotaryEmbedding.__call__" title="Link to this definition"></a></dt>
<dd><p>Generate rotary embeddings from position ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>position_ids</strong> – Position indices of shape [batch_size, seq_len]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (cos, sin) tensors for rotary embeddings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaRotaryEmbedding.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaRotaryEmbedding.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaRotaryEmbedding.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize RoPE module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> – Dimension of the embeddings (must be even)</p></li>
<li><p><strong>base</strong> – Base for the sinusoidal functions</p></li>
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaTransformerBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">LlamaTransformerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaTransformerBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaTransformerBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>LLama transformer block implementation.</p>
<p>This implements a single layer of the LLama transformer, consisting of
attention, layer normalization, and MLP components.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaTransformerBlock.input_layernorm">
<span class="sig-name descname"><span class="pre">input_layernorm</span></span><a class="headerlink" href="#jaxgarden.models.LlamaTransformerBlock.input_layernorm" title="Link to this definition"></a></dt>
<dd><p>Layer normalization before attention</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaTransformerBlock.attention">
<span class="sig-name descname"><span class="pre">attention</span></span><a class="headerlink" href="#jaxgarden.models.LlamaTransformerBlock.attention" title="Link to this definition"></a></dt>
<dd><p>Multi-headed attention</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaTransformerBlock.post_attention_layernorm">
<span class="sig-name descname"><span class="pre">post_attention_layernorm</span></span><a class="headerlink" href="#jaxgarden.models.LlamaTransformerBlock.post_attention_layernorm" title="Link to this definition"></a></dt>
<dd><p>Layer normalization after attention</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaTransformerBlock.mlp">
<span class="sig-name descname"><span class="pre">mlp</span></span><a class="headerlink" href="#jaxgarden.models.LlamaTransformerBlock.mlp" title="Link to this definition"></a></dt>
<dd><p>MLP block</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaTransformerBlock.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaTransformerBlock.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaTransformerBlock.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply transformer block to input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input tensor of shape [batch_size, seq_len, dim]</p></li>
<li><p><strong>position_ids</strong> – Position indices of shape [batch_size, seq_len]</p></li>
<li><p><strong>attention_mask</strong> – Additive attention mask of shape (batch_size, 1, q_len, kv_len)
or another shape that can be broadcasted to this shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor of shape [batch_size, seq_len, dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.LlamaTransformerBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_kv_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rope_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/llama.html#LlamaTransformerBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.LlamaTransformerBlock.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize transformer block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_idx</strong> – Index of the layer</p></li>
<li><p><strong>dim</strong> – Size of hidden states</p></li>
<li><p><strong>n_heads</strong> – Number of attention heads</p></li>
<li><p><strong>n_kv_heads</strong> – Number of key/value heads</p></li>
<li><p><strong>head_dim</strong> – Dimension of each attention head</p></li>
<li><p><strong>rope_theta</strong> – Base for rotary position embeddings</p></li>
<li><p><strong>intermediate_size</strong> – Size of MLP intermediate layer</p></li>
<li><p><strong>norm_eps</strong> – Epsilon for layer normalization</p></li>
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBERTEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">ModernBERTEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBERTEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBERTEncoder" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>ModernBERT encoder consisting of multiple transformer layers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBERTEncoder.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sliding_window_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_attentions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBERTEncoder.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBERTEncoder.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply transformer encoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_states</strong> – Input tensor</p></li>
<li><p><strong>attention_mask</strong> – Optional attention mask</p></li>
<li><p><strong>sliding_window_mask</strong> – Optional sliding window mask</p></li>
<li><p><strong>position_ids</strong> – Optional position ids</p></li>
<li><p><strong>deterministic</strong> – Whether to apply dropout</p></li>
<li><p><strong>output_attentions</strong> – Whether to return attention weights</p></li>
<li><p><strong>output_hidden_states</strong> – Whether to return all hidden states</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Output tensor</p></li>
<li><p>All hidden states (optional, if output_hidden_states=True)</p></li>
<li><p>All attention weights (optional, if output_attentions=True)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBERTEncoder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_attention_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_rope_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_position_embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_attention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-1,</span> <span class="pre">-1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_rope_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_attn_every_n_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBERTEncoder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBERTEncoder.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize encoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
<li><p><strong>hidden_size</strong> – Size of hidden states</p></li>
<li><p><strong>num_attention_heads</strong> – Number of attention heads</p></li>
<li><p><strong>intermediate_size</strong> – Size of MLP intermediate layer</p></li>
<li><p><strong>num_hidden_layers</strong> – Number of transformer layers</p></li>
<li><p><strong>attention_dropout</strong> – Dropout probability for attention</p></li>
<li><p><strong>hidden_dropout</strong> – Dropout probability for hidden states</p></li>
<li><p><strong>attention_bias</strong> – Whether to use bias in attention</p></li>
<li><p><strong>norm_eps</strong> – Epsilon for layer normalization</p></li>
<li><p><strong>norm_bias</strong> – Whether to use bias in layer normalization</p></li>
<li><p><strong>global_rope_theta</strong> – Base for global RoPE</p></li>
<li><p><strong>max_position_embeddings</strong> – Maximum sequence length</p></li>
<li><p><strong>local_attention</strong> – Tuple of (left, right) window sizes</p></li>
<li><p><strong>local_rope_theta</strong> – Base for local RoPE (optional)</p></li>
<li><p><strong>global_attn_every_n_layers</strong> – Apply global attention every N layers</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBERTForMaskedLM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">ModernBERTForMaskedLM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBERTForMaskedLM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBERTForMaskedLM" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxgarden.models.BaseModel" title="jaxgarden.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>ModernBERT model with masked language modeling head.</p>
<p>This implements the ModernBERT architecture as described in the paper
“Smarter, Better, Faster, Longer: A Modern Bidirectional Encoder for Fast, Memory Efficient,
and Long Context Finetuning and Inference” by Answer.AI.</p>
<p>The implementation includes modern improvements such as:
- Rotary Position Embeddings (RoPE)
- Mixed global/local attention mechanism
- Pre-LayerNorm architecture
- Efficient parameter sharing</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBERTForMaskedLM.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sliding_window_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs_embeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_attentions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBERTForMaskedLM.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBERTForMaskedLM.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply ModernBERT model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_ids</strong> – Input token ids of shape [batch_size, seq_len]</p></li>
<li><p><strong>attention_mask</strong> – Optional attention mask</p></li>
<li><p><strong>sliding_window_mask</strong> – Optional sliding window mask</p></li>
<li><p><strong>position_ids</strong> – Optional position ids</p></li>
<li><p><strong>inputs_embeds</strong> – Optional pre-computed embeddings</p></li>
<li><p><strong>deterministic</strong> – Whether to apply dropout</p></li>
<li><p><strong>output_attentions</strong> – Whether to return attention weights</p></li>
<li><p><strong>output_hidden_states</strong> – Whether to return all hidden states</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>logits: Output logits of shape [batch_size, seq_len, vocab_size]</p></li>
<li><p>hidden_states: All hidden states (optional)</p></li>
<li><p>attentions: All attention weights (optional)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBERTForMaskedLM.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config:</span> <span class="pre">~jaxgarden.models.modernbert.ModernBERTConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision:</span> <span class="pre">~jax._src.lax.lax.Precision</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs:</span> <span class="pre">~flax.nnx.rnglib.Rngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBERTForMaskedLM.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBERTForMaskedLM.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize ModernBERT model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Configuration for ModernBERT model</p></li>
<li><p><strong>dtype</strong> – Data type in which computation is performed</p></li>
<li><p><strong>param_dtype</strong> – Data type in which params are stored</p></li>
<li><p><strong>precision</strong> – Numerical precision</p></li>
<li><p><strong>rngs</strong> – Random number generators for param initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">ModernBertAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Multi-headed self attention implementation.</p>
<p>This implements the standard attention mechanism with RoPE (Rotary Position Embeddings).
Supports both global attention and sliding window attention.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertAttention.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sliding_window_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_attentions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertAttention.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertAttention.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply attention module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_states</strong> – Input tensor of shape [batch_size, seq_len, hidden_size]</p></li>
<li><p><strong>attention_mask</strong> – Optional attention mask</p></li>
<li><p><strong>sliding_window_mask</strong> – Optional sliding window mask for local attention</p></li>
<li><p><strong>position_ids</strong> – Optional position ids for RoPE</p></li>
<li><p><strong>deterministic</strong> – Whether to apply dropout</p></li>
<li><p><strong>output_attentions</strong> – Whether to return attention probabilities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Output tensor of shape [batch_size, seq_len, hidden_size]</p></li>
<li><p>Attention probabilities (optional) of shape [b_size, n_heads, seq_len, seq_len]</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_attention_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_rope_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_position_embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_attention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-1,</span> <span class="pre">-1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_rope_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_attn_every_n_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertAttention.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize attention module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
<li><p><strong>hidden_size</strong> – Size of hidden states</p></li>
<li><p><strong>num_attention_heads</strong> – Number of attention heads</p></li>
<li><p><strong>attention_dropout</strong> – Dropout probability for attention weights</p></li>
<li><p><strong>attention_bias</strong> – Whether to use bias in linear layers</p></li>
<li><p><strong>global_rope_theta</strong> – Base for global RoPE</p></li>
<li><p><strong>max_position_embeddings</strong> – Maximum sequence length</p></li>
<li><p><strong>local_attention</strong> – Tuple of (left, right) window sizes for local attention</p></li>
<li><p><strong>local_rope_theta</strong> – Base for local RoPE (optional)</p></li>
<li><p><strong>layer_id</strong> – Layer index for determining attention type</p></li>
<li><p><strong>global_attn_every_n_layers</strong> – Apply global attention every N layers</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertEmbeddings">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">ModernBertEmbeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertEmbeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertEmbeddings" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Token embeddings with normalization and dropout.</p>
<p>Similar to BERT embeddings but without position embeddings since we use RoPE.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertEmbeddings.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs_embeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertEmbeddings.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertEmbeddings.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply embeddings module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_ids</strong> – Integer tokens of shape [batch_size, seq_len]</p></li>
<li><p><strong>deterministic</strong> – Whether to apply dropout</p></li>
<li><p><strong>inputs_embeds</strong> – Optional pre-computed embeddings</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedded tokens with shape [batch_size, seq_len, hidden_size]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertEmbeddings.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertEmbeddings.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertEmbeddings.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize embeddings module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
<li><p><strong>vocab_size</strong> – Size of the vocabulary</p></li>
<li><p><strong>hidden_size</strong> – Size of the embeddings</p></li>
<li><p><strong>pad_token_id</strong> – Token ID to use for padding</p></li>
<li><p><strong>norm_eps</strong> – Epsilon for layer normalization</p></li>
<li><p><strong>norm_bias</strong> – Whether to use bias in layer normalization</p></li>
<li><p><strong>embedding_dropout</strong> – Dropout probability for embeddings</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">ModernBertLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertLayer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>ModernBERT transformer layer with pre-LayerNorm architecture.</p>
<p>This implements a transformer layer with:
1. Pre-LayerNorm for attention and MLP
2. Residual connections
3. Optional identity for first layer’s attention norm</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertLayer.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sliding_window_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_attentions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertLayer.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertLayer.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply transformer layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_states</strong> – Input tensor of shape [batch_size, seq_len, hidden_size]</p></li>
<li><p><strong>attention_mask</strong> – Optional attention mask</p></li>
<li><p><strong>sliding_window_mask</strong> – Optional sliding window mask</p></li>
<li><p><strong>position_ids</strong> – Optional position ids for RoPE</p></li>
<li><p><strong>deterministic</strong> – Whether to apply dropout</p></li>
<li><p><strong>output_attentions</strong> – Whether to return attention probabilities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Output tensor of shape [batch_size, seq_len, hidden_size]</p></li>
<li><p>Attention probabilities (optional) of shape [b_size, n_heads, seq_len, seq_len]</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertLayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_attention_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_rope_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_position_embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_attention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-1,</span> <span class="pre">-1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_rope_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_attn_every_n_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertLayer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertLayer.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize transformer layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
<li><p><strong>hidden_size</strong> – Size of hidden states</p></li>
<li><p><strong>num_attention_heads</strong> – Number of attention heads</p></li>
<li><p><strong>intermediate_size</strong> – Size of MLP intermediate layer</p></li>
<li><p><strong>layer_id</strong> – Layer index (first layer uses identity for attn norm)</p></li>
<li><p><strong>attention_dropout</strong> – Dropout probability for attention</p></li>
<li><p><strong>hidden_dropout</strong> – Dropout probability for hidden states</p></li>
<li><p><strong>attention_bias</strong> – Whether to use bias in attention</p></li>
<li><p><strong>norm_eps</strong> – Epsilon for layer normalization</p></li>
<li><p><strong>norm_bias</strong> – Whether to use bias in layer normalization</p></li>
<li><p><strong>global_rope_theta</strong> – Base for global RoPE</p></li>
<li><p><strong>max_position_embeddings</strong> – Maximum sequence length</p></li>
<li><p><strong>local_attention</strong> – Tuple of (left, right) window sizes</p></li>
<li><p><strong>local_rope_theta</strong> – Base for local RoPE (optional)</p></li>
<li><p><strong>global_attn_every_n_layers</strong> – Apply global attention every N layers</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertMLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jaxgarden.models.</span></span><span class="sig-name descname"><span class="pre">ModernBertMLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertMLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertMLP" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module" title="(in Flax)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>MLP with gated linear units.</p>
<p>Replaces the traditional intermediate + output layers with a single gated MLP.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertMLP.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></span></span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertMLP.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertMLP.__call__" title="Link to this definition"></a></dt>
<dd><p>Apply MLP module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_states</strong> – Input tensor of shape [batch_size, seq_len, hidden_size]</p></li>
<li><p><strong>deterministic</strong> – Whether to apply dropout</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor of shape [batch_size, seq_len, hidden_size]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxgarden.models.ModernBertMLP.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs" title="(in Flax)"><span class="pre">Rngs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jaxgarden/models/modernbert.html#ModernBertMLP.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxgarden.models.ModernBertMLP.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize MLP module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rngs</strong> – PRNG key collection</p></li>
<li><p><strong>hidden_size</strong> – Size of input and output</p></li>
<li><p><strong>intermediate_size</strong> – Size of intermediate layer</p></li>
<li><p><strong>mlp_bias</strong> – Whether to use bias in linear layers</p></li>
<li><p><strong>mlp_dropout</strong> – Dropout probability</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to JAXgarden documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, JAXgarden Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>